<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=yes"/>
		<title>中原楼市</title>
		<link rel="stylesheet" type="text/css" href="css/home.css"/>
		<script src="../../js/js.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<header class="headers">
			<input type="text" class="iconfont search" placeholder="&#xe647; 买新房，耿优惠" />
		</header>
		<section class="contents">
			<div class="swiper-container swiper1">
			  <div class="swiper-wrapper">
			    <div class="swiper-slide">
			    	<img src=" "/>
			    </div>
			    <div class="swiper-slide">slider2</div>
			    <div class="swiper-slide">slider3</div>
			  </div>
			  <div class="swiper-pagination"></div>
			</div>
			<div class="menu">
				<a href="javascript:;">
					<img src="../../img/croom.png" alt="" />
					<span>新房</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/cshops.png" alt="" />
					<span>商铺</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/clive.png" alt="" />
					<span>直播</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/clooking.png" alt="" />
					<span>地图找房</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/cwallet.png" alt="" />
					<span>返金卡</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/cpreferential.png" alt="" />
					<span>购房惠</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/cooperation.png" alt="" />
					<span>call房圈</span>
				</a>
				<a href="javascript:;">
					<img src="../../img/cweixin.png" alt="" />
					<span>官方微信</span>
				</a>
			</div>
			
			<div class="nows">
				<div>
					<div>
						<p>本周值得买</p>
						<p>单价1万1起</p>
					</div>
					<img src="" alt="" />
				</div>
				<div>
					<div>
						<p>本周值得买</p>
						<p>单价1万1起</p>
					</div>
					<img src="" alt="" />
				</div>
				<div>
					<div>
						<p>本周值得买</p>
						<p>单价1万1起</p>
					</div>
					<img src="" alt="" />
				</div>
				<div>
					<div>
						<p>本周值得买</p>
						<p>单价1万1起</p>
					</div>
					<img src="" alt="" />
				</div>
			</div>
			<div class="preferential">
				<img src="../../img/rebate_banners.png"/>
			</div>
			<div class="tabBars_box">
				<ul class="tabBar">
					<li class="selecteds">
						<p class="">行业资讯</p>
						<div></div>
					</li>
					<li>
						<p>地产快讯</p>
						<div></div>
					</li>
					<li>
						<p>最新优惠</p>
						<div></div>
					</li>
				</ul>
			</div>
			<div class="swiper-container swiper2">
				<div class="swiper-wrapper">
					<div class="swiper-slide">
						<div class="information">
							<div>
								<div>10强房企年内拿地3514亿，海外融资同比翻倍</div>
								<p>2018年5月9日</p>
							</div>
							<img src="" alt="" />
						</div>
						<div class="information">
							<div>
								<div>10强房企年内拿地3514亿，海外融资同比翻倍</div>
								<p>2018年5月9日</p>
							</div>
							<img src="" alt="" />
						</div>
						<div class="information">
							<div>
								<div>10强房企年内拿地3514亿，海外融资同比翻倍</div>
								<p>2018年5月9日</p>
							</div>
							<img src="" alt="" />
						</div>
						<div class="information">
							<div>
								<div>10强房企年内拿地3514亿，海外融资同比翻倍</div>
								<p>2018年5月9日</p>
							</div>
							<img src="" alt="" />
						</div>
					</div>
					<div class="swiper-slide">slider2</div>
					<div class="swiper-slide">slider3</div>
				</div>
			</div>
			
			<div class="updates">
				<div>换一换<i class="iconfont">&#xe60c;</i></div>
				<div>查看更多<i class="iconfont">&#xe61c;</i></div>
			</div>
			
			
			
			
			<div class="tabBars_box">
				<ul class="tabBars">
					<li class="selecteds">
						<p class="">推荐</p>
						<div></div>
					</li>
					<li>
						<p>新房</p>
						<div></div>
					</li>
					<li>
						<p>品质房</p>
						<div></div>
					</li>
					<li>
						<p>经济房</p>
						<div></div>
					</li>
					<li>
						<p>优惠房</p>
						<div></div>
					</li>
				</ul>
			</div>
			
			<div class="swiper-container swiper3">
				<div class="swiper-wrapper">
					<div class="swiper-slide">
						<div class="ma">
							<div class="swiper-container swiper4">
								<div class="swiper-wrapper">
									<div class="swiper-slide">
										<img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-mimall-media/37dfdc929ee9a4313facb0b23ebcd721.jpg?thumb=1&w=720&h=360" alt="" />
										<p>高绿化率</p>
										<p>绿化覆盖 空气清晰</p>
									</div>
									<div class="swiper-slide">
										<img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-mimall-media/37dfdc929ee9a4313facb0b23ebcd721.jpg?thumb=1&w=720&h=360" alt="" />
										<p>高绿化率</p>
										<p>绿化覆盖 空气清晰</p>
									</div>
									<div class="swiper-slide">
										<img src="" alt="" />
										<p>高绿化率</p>
										<p>绿化覆盖 空气清晰</p>
									</div>
									<div class="swiper-slide">slider4</div>
									<div class="swiper-slide">slider5</div>
								</div>
							</div>
							<div class="building_box box1"></div>
						</div>
					</div>
					<div class="swiper-slide">
						<div class="ksk"></div>
					</div>
					<div class="swiper-slide">slider3</div>
					<div class="swiper-slide">slider4</div>
					<div class="swiper-slide">slider5</div>
				</div>
				<div class="swiper-pagination"></div>
			</div>
		</section>
<script src="js/home.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	$(function(){
		for(var i=0;i<30;i++){
			$(".ksk").append(`<div>${i+1}-----slider2</div>`);
		}
		
		var headers=$("header")[0].getBoundingClientRect().height;
		var tabBark=$(".tabBars").outerHeight(true);
		var tabBars=$(".tabBars").offset().top;
		var heights=tabBars-headers;
		var bodyHeight=$(window).height();
		var khk=bodyHeight-(headers+tabBark);
		$(".swiper3").css({"height":khk});
		$(".swiper3>.swiper-wrapper>.swiper-slide").css({"height":bodyHeight});
		var mySwiper1 = new Swiper('.swiper1', {
			loop : true,
			autoplay: 2000,//可选选项，自动滑动
			pagination : '.swiper-pagination',
		})
		var mySwiper4 = new Swiper('.swiper4', {
			slidesPerView :2.6,
			observer:true,//修改swiper自己或子元素时，自动初始化swiper
	    	observeParents:true,//修改swiper的父元素时，自动初始化swiper
	    	spaceBetween :10,
		})
		var mySwiper2=new Swiper(".swiper2",{
			loop:true,//循环
			observer:true,//修改swiper自己或子元素时，自动初始化swiper
	    	observeParents:true,//修改swiper的父元素时，自动初始化swiper
			onSlideChangeStart:function(swiper){//swiper3中使用
		        var xiabiao=swiper.realIndex;//循环状态下获取下标
		        $(".tabBar>li").eq(xiabiao).addClass("selecteds");
		        $(".tabBar>li").eq(xiabiao).siblings().removeClass("selecteds");
		   }
		})
		$(".tabBar>li").click(function(){
		    var zuobiao=$(this).index();
		    $(".tabBar>li").eq(zuobiao).addClass("selecteds");
		    $(".tabBar>li").eq(zuobiao).siblings().removeClass("selecteds");
		    mySwiper2.slideTo(zuobiao+1,500,false);
		})
		var mySwiper3=new Swiper(".swiper3",{
			loop:true,//循环
			observer:true,//修改swiper自己或子元素时，自动初始化swiper
	    	observeParents:true,//修改swiper的父元素时，自动初始化swiper
			onSlideChangeStart:function(swiper){//swiper3中使用
		        var xiabiao=swiper.realIndex;//循环状态下获取下标
		        $(".tabBars>li").eq(xiabiao).addClass("selecteds");
		        $(".tabBars>li").eq(xiabiao).siblings().removeClass("selecteds");
		   }
		})
		$(".tabBars>li").click(function(){
		    var zuobiao=$(this).index();
		    $(".tabBars>li").eq(zuobiao).addClass("selecteds");
		    $(".tabBars>li").eq(zuobiao).siblings().removeClass("selecteds");
		    mySwiper3.slideTo(zuobiao+1,500,false);
		})
		
		//分页
		var page = 1, //分页码
	    off_on = false; //分页开关
		//加载数据
		var LoadingDataFn = function(box) {
//			var menu=6;//每次加载几条数据
//			var start=(page-1)*menu;//从哪里开始
//			var end=page*menu;//到哪里结束
		    var dom = '';
		    for (var i =0; i <6; i++) {
//		    for (var i =start; i <end; i++) {
		    	if(data[i]==undefined){
		    		console.log(666);
		    		alert("没有数据了");
		    		return ;
		    	}
				var aa='',as='',region=data[i].region;
				for(j in region){
					if(j==region.length-1){
						aa+=`${region[j]}`;
					}else{
						aa+=`${region[j]}&nbsp;`;
					}
				}
				if(data[i].state=="在售"){
					as=`<div class="state statea">${data[i].state}</div>`;
				}else if(data[i].state=="待售"){
					as=`<div class="state stateb">${data[i].state}</div>`;
				}else{
					as=`<div class="state">${data[i].state}</div>`;
				}
				dom+=`<div class="buildings">
										<img src=${data[i].img} alt="" />
										<div>
											<div>${data[i].name}</div>
											<div class="region">
												<div>${aa}</div>
												<div>${data[i].mianji}</div>
											</div>
											<div class="features">
												${as}
												<div>南北通透</div>
												<div>配套成熟</div>
											</div>
											<div>售价待定</div>
										</div>
									</div>`;
		    }
		    $(".box1").append(dom);
		    off_on = true; //[重要]off_on 在这里不设 true的话， 下次就没法加载了哦！]
		};
		LoadingDataFn();
		$('.ma').scroll(function() {
		    //当时滚动条离底部60px时开始加载下一页的内容
		    if (($(this)[0].scrollTop + $(this).height() + 60) >= $(this)[0].scrollHeight) {
		        //这里用 [ off_on ] 来控制是否加载 （这样就解决了 当上页的条件满足时，一下子加载多次的问题啦）
		        if (off_on) {
		            off_on = false;
		            page++;
		            console.log("第"+page+"页");
		            LoadingDataFn();  //调用执行上面的加载方法
		        }
		    }
		});
		function fixed(num) {
	        var nys= navigator.userAgent;
	        var isAndroid = nys.indexOf('Android') > -1 || nys.indexOf('Adr') > -1; 
	        var isIOS = !!nys.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); 
	        if(isAndroid){
	            document.body.onscroll = function(e){
	                var scrollT = document.body.scrollTop;
	                if (scrollT > num) {
	                    $('.tabBars').addClass('fixed-top');
	                    $(".swiper3>.swiper-wrapper>.swiper-slide>div").css({"overflow":"auto"});
	                }else {
	                    $('.tabBars').removeClass('fixed-top');
	                    $(".swiper3>.swiper-wrapper>.swiper-slide>div").scrollTop(0);//滚动条回到顶部
	                    $(".swiper3>.swiper-wrapper>.swiper-slide>div").css({"overflow":"hidden"});
	                }
	            };
	        }else if(isIOS) {
	            $('.tabBars').addClass('sticky');
	        }
		    if (($(this)[0].scrollTop + $(this).height() + 60) >= $(this)[0].scrollHeight) {
		    	console.log(111);
		        //这里用 [ off_on ] 来控制是否加载 （这样就解决了 当上页的条件满足时，一下子加载多次的问题啦）
		        if (off_on) {
		              off_on = false;
		              page++;
		              console.log("第"+page+"页");
		              LoadingDataFn();  //调用执行上面的加载方法
		        }
		    }
	    }
	    fixed(heights);
	})
</script>
	</body>
</html>
